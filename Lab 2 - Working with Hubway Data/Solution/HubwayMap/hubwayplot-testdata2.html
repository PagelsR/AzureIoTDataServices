<!DOCTYPE html>
<html>
<head>
    <title>Azure Maps Bubble Layer</title>
    <meta charset="utf-8" />
    <script src="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js"></script>
    <style>
        html, body, #myMap {
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
        }
    </style>
</head>
<body>
    <div id="myMap"></div>
    <script>
        var subscriptionKey = "-tIVJM5k2FzuDZw27e8uBi5z6hy-pXjGfj0A9nnG81U"; // Replace with your Azure Maps subscription key

        var map = new atlas.Map("myMap", {
            center: [-71.093198, 42.3581],
            zoom: 12,
            view: 'Auto',
            authOptions: {
                authType: 'subscriptionKey',
                subscriptionKey: subscriptionKey
            }
        });

        map.events.add('ready', function () {
            var data = {
                "type": "FeatureCollection",
                "features": [
                    {
                        "type": "Feature",
                        "properties": {
                            "numberOfStations": 27,
                            "startStationID": "76",
                            "startStationName": "Central Sq Post Office / Cambridge City Hall at Mass Ave / Pleasant St"
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-71.105495, 42.366426]
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "numberOfStations": 55,
                            "startStationID": "67",
                            "startStationName": "MIT at Mass Ave / Amherst St"
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-71.093198, 42.3581]
                        }
                    },
                    {
                        "type": "Feature",
                        "properties": {
                            "numberOfStations": 7,
                            "startStationID": "73",
                            "startStationName": "Harvard Square at Brattle St / Eliot St"
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-71.120886, 42.373231]
                        }
                    }
                ]
            };

            var dataSource = new atlas.source.DataSource();
            map.sources.add(dataSource);

            // Add the data to the data source.
            dataSource.add(data);

            // Create a bubble layer for rendering clustered data points.
            var bubbleLayer = new atlas.layer.BubbleLayer(dataSource, null, {
                radius: [
                    'interpolate',
                    ['linear'],
                    ['get', 'numberOfStations'],
                    0, 3,
                    50, 40
                ],
                color: '#007BFA',
                strokeColor: 'white',
                strokeWidth: 2,
                filter: ['has', 'numberOfStations']
            });

            map.layers.add(bubbleLayer);
        });
    </script>
</body>
</html>